{"version":3,"sources":["../../routes/create.js"],"names":["express","require","router","Router","path","jf","async","categories","dances","filenameLookup","readFile","join","err","obj","console","log","get","req","res","next","query","dance","error","stepData","getStepsCallback","render","title","levels","steps","params","danceId","send","module","exports"],"mappings":";;AAAA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAMC,OAAOH,QAAQ,MAAR,CAAb;AACA,IAAMI,KAAKJ,QAAQ,UAAR,CAAX;AACA,IAAMK,QAAQL,QAAQ,OAAR,CAAd;AACA,IAAIM,aAAa,EAAjB;AACA,IAAIC,SAAS,EAAb;AACA,IAAMC,iBAAiB;AACnB,eAAW;AADQ,CAAvB;;AAIAJ,GAAGK,QAAH,CAAYN,KAAKO,IAAL,CAAU,QAAV,EAAoB,MAApB,EAA4B,aAA5B,CAAZ,EAAwD,UAAUC,GAAV,EAAeC,GAAf,EAAoB;AACxE,QAAIA,GAAJ,EAAS;AACLN,qBAAaM,GAAb;AACAC,gBAAQC,GAAR,CAAYR,UAAZ;AAEH,KAJD,MAKK;AACDO,gBAAQC,GAAR,CAAYH,GAAZ;AACH;AACJ,CATD;;AAWA;AACAV,OAAOc,GAAP,CAAW,2BAAX,EAAwC,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC9D;;;;;AAKAL,YAAQC,GAAR,CAAY,YAAYE,IAAIG,KAAJ,CAAU,OAAV,CAAZ,GAAiC,UAAjC,GAA8CH,IAAIG,KAAJ,CAAU,OAAV,CAA9C,GAAmE,aAAnE,GAAmFH,IAAIG,KAAJ,CAAU,UAAV,CAA/F;AACA,QAAMC,QAAQJ,IAAIG,KAAJ,CAAU,OAAV,CAAd;AACA,QAAIC,SAASZ,eAAeY,KAAf,CAAb,EAAoC;AAChChB,WAAGK,QAAH,CAAYN,KAAKO,IAAL,CAAU,QAAV,EAAoB,MAApB,EAA4BF,eAAeY,KAAf,CAA5B,CAAZ,EAAgE,UAAUC,KAAV,EAAiBC,QAAjB,EAA2B;AAAE;AACzF,gBAAID,KAAJ,EAAW;AACPE,iCAAiBF,KAAjB;AACH,aAFD,MAGK;AACDJ,oBAAIO,MAAJ,CAAW,QAAX,EAAqB;AACjBC,2BAAO,YAAYL,KAAZ,GAAoB,UADV;AAEjBM,4BAAQ,CAAC,UAAD,EAAa,QAAb,EAAuB,QAAvB,EAAiC,MAAjC,EAAyC,MAAzC,CAFS;AAGjBpB,gCAAYA,UAHK;AAIjBqB,2BAAOL;AAJU,iBAArB;AAMH;AACJ,SAZD;AAcH,KAfD,MAgBK;AACDL,YAAIO,MAAJ,CAAW,QAAX,EAAqB;AACjBC,mBAAO,gBADU;AAEjBC,oBAAQ,CAAC,UAAD,EAAa,QAAb,EAAuB,QAAvB,EAAiC,MAAjC,EAAyC,MAAzC,CAFS;AAGjBpB,wBAAYA,UAHK;AAIjBqB,mBAAO;AAJU,SAArB;AAMH;AAEJ,CAjCD;;AAmCA1B,OAAOc,GAAP,CAAW,UAAX,EAAuB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAC7CL,YAAQC,GAAR,CAAYE,IAAIY,MAAJ,CAAWC,OAAvB;AACAZ,QAAIa,IAAJ,CAAS,kBAAkBd,IAAIY,MAAJ,CAAWC,OAAtC;AACH,CAHD;;AAKAE,OAAOC,OAAP,GAAiB/B,MAAjB","file":"create.js","sourcesContent":["var express = require('express');\r\nvar router = express.Router();\r\nconst path = require('path');\r\nconst jf = require('jsonfile');\r\nconst async = require('async');\r\nvar categories = [];\r\nvar dances = [];\r\nconst filenameLookup = {\r\n    \"Cha-Cha\": \"cha_cha.json\"\r\n};\r\n\r\njf.readFile(path.join('public', 'data', 'dances.json'), function (err, obj) {\r\n    if (obj) {\r\n        categories = obj;\r\n        console.log(categories)\r\n\r\n    }\r\n    else {\r\n        console.log(err)\r\n    }\r\n});\r\n\r\n/* GET create page */\r\nrouter.get('/:level?:category?:dance?', function (req, res, next) {\r\n    /* res.json({\r\n        level: req.query.level,\r\n        category: req.query.category,\r\n        dance: req.query.dance\r\n    }); */\r\n    console.log(\"level: \" + req.query['level'] + \" dance: \" + req.query['dance'] + \" category: \" + req.query['category']);\r\n    const dance = req.query['dance'];\r\n    if (dance && filenameLookup[dance]) {\r\n        jf.readFile(path.join('public', 'data', filenameLookup[dance]), function (error, stepData) { //TODO Replace this with a DB read\r\n            if (error) {\r\n                getStepsCallback(error);\r\n            }\r\n            else {\r\n                res.render('create', {\r\n                    title: 'Create ' + dance + ' Routine',\r\n                    levels: ['Newcomer', 'Bronze', 'Silver', 'Gold', 'Open'],\r\n                    categories: categories,\r\n                    steps: stepData\r\n                });\r\n            }\r\n        });\r\n\r\n    }\r\n    else {\r\n        res.render('create', {\r\n            title: 'Create Routine',\r\n            levels: ['Newcomer', 'Bronze', 'Silver', 'Gold', 'Open'],\r\n            categories: categories,\r\n            steps: []\r\n        });\r\n    }\r\n\r\n});\r\n\r\nrouter.get(':danceId', function (req, res, next) {\r\n    console.log(req.params.danceId);\r\n    res.send(\"set dance to \" + req.params.danceId)\r\n});\r\n\r\nmodule.exports = router;"]}